
import java.io.UnsupportedEncodingException;
import java.util.Scanner;


public class Main {
    public static void main(String args[]) throws UnsupportedEncodingException {
        Searcher searcher = new Searcher();
        VulnSeeker vulnSeeker = new VulnSeeker();
        
        Scanner scan = new Scanner(System.in);
        System.out.println("Type a word for the inurl Google search:");
        String keyWord = scan.nextLine();
        System.out.println("Searching for sites that contain \""+keyWord+"\" in their URLs...");

        String[] resultURLs = searcher.search("inurl: "+keyWord);
        
        System.out.println("\nSites found:");

        for(int i = 0; i < resultURLs.length; i++) {
            System.out.println(resultURLs[i]);
        }
        
        System.out.println("\nSites that may be vulnerable to SQL injection:");
        
        String[] vulnerableURLs = vulnSeeker.findVulnerables(resultURLs);
        
        for(int i = 0; i < vulnerableURLs.length; i++) {
            System.out.println(vulnerableURLs[i]);
        }
        
        float vulnPerc = ((float) vulnerableURLs.length / resultURLs.length)*100;
        
        System.out.println(vulnPerc+"% of the sites searched may be vulnerable to SQL injection.");
    }
}
